{% import "macros.html" as macros %}
{% extends "index.html" %}

{% block content %}

{% set citations = load_data(path="static/references.bib", format="bibtex") -%}
{% set sorted_bib = citations.bibliographies %}

<div>
    {% set_global last_year = "" %}
    {%- for bib in sorted_bib | sort(attribute="tags.year") | reverse %}
    {%- if last_year != bib.tags.year %}
        <h1 class="pub-year">{{bib.tags.year}}</h1>
        {%- set_global last_year = bib.tags.year -%}
    {% endif -%}

    <div class="publication">
        {% set _title = macros::process_bib(text=bib.tags.title) %}
        <h2>{{_title}}</h2>
        <p>
            {{macros::print_ref(bib=bib)}}
        </p>
    </div>
    {% endfor -%}
</div>

{% endblock content %}
